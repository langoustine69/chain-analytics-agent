import { A as AgentMeta, a as AgentRuntime, E as EntrypointDef, b as AgentCardWithEntrypoints } from '../agent-F8ANF2KR.js';
export { c as AgentConfig, e as AgentContext, d as AgentCore, f as EntrypointHandler, g as EntrypointStreamHandler, h as EntrypointsRuntime, U as Usage, Z as ZodValidationError } from '../agent-F8ANF2KR.js';
export { Network } from 'x402/types';
import { z } from 'zod';
import '../ap2/index.js';
import '../http/index.js';
import '../identity/index.js';
import '../wallets/index.js';
import 'viem';

/**
 * Build context provided to extensions during build.
 */
type BuildContext = {
    meta: AgentMeta;
    runtime: Partial<AgentRuntime>;
};
/**
 * Extension interface. Each extension contributes a runtime slice.
 */
interface Extension<R extends Record<string, unknown> = {}> {
    /**
     * Unique name of the extension (for debugging and conflict detection).
     */
    name: string;
    /**
     * Builds the extension's runtime slice.
     * Called during AgentBuilder.build() to construct the runtime.
     */
    build: (ctx: BuildContext) => R;
    /**
     * Optional hook called when an entrypoint is added to the runtime.
     * Useful for extensions that need to activate/enable themselves per entrypoint.
     */
    onEntrypointAdded?: (entrypoint: EntrypointDef, runtime: AgentRuntime) => void;
    /**
     * Optional hook called after all extensions are built.
     * Useful for final setup that requires the complete runtime.
     * Can be async for initialization that requires async operations.
     */
    onBuild?: (runtime: AgentRuntime) => void | Promise<void>;
    /**
     * Optional hook called when building the manifest/agent card.
     * Can modify the card before it's returned.
     */
    onManifestBuild?: (card: AgentCardWithEntrypoints, runtime: AgentRuntime) => AgentCardWithEntrypoints;
}
/**
 * Type utility to convert a union of types to an intersection.
 * Used for merging extension runtime types.
 *
 * @example
 * ```typescript
 * type A = { a: string };
 * type B = { b: number };
 * type Combined = UnionToIntersection<A | B>; // { a: string } & { b: number }
 * ```
 */
type UnionToIntersection<U> = (U extends any ? (k: U) => void : never) extends (k: infer I) => void ? I : never;
/**
 * Type utility to extract the runtime type from an array of extensions.
 * Merges all extension runtime slices into a single type.
 *
 * This is useful for type inference when using the extension system:
 *
 * @example
 * ```typescript
 * const payments = payments({ config });
 * const http = http();
 * type MyRuntime = AppRuntime<[typeof payments, typeof http]>;
 * ```
 */
type AppRuntime<Es extends Extension[]> = UnionToIntersection<Es[number] extends Extension<infer R> ? R : never>;

/**
 * Return type for adapter-specific `createAgentApp` functions.
 * Generic over the app type to support different frameworks (Hono, Express, etc.).
 *
 * The runtime, agent, and config types are inferred from the actual return value
 * of `createAgentHttpRuntime` to avoid circular dependencies.
 */
type CreateAgentAppReturn<TApp = unknown, TRuntime = any, TAgent = any> = {
    app: TApp;
    runtime: TRuntime;
    agent: TAgent;
    addEntrypoint: <TInput extends z.ZodTypeAny | undefined = z.ZodTypeAny | undefined, TOutput extends z.ZodTypeAny | undefined = z.ZodTypeAny | undefined>(def: EntrypointDef<TInput, TOutput>) => void;
};

export { AgentRuntime, type AppRuntime, type BuildContext, type CreateAgentAppReturn, EntrypointDef, type Extension, type UnionToIntersection };
